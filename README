# Workflow1

# Description: Contains applications neeed for a regional loss estimaion
# due to an earthquake event. Applications in subdirectories:

1. createBIM - given UrbanSim data generate BIM models
2. createEVENT - given BIM model get input motion for building (the EVENT)
3. createSAM - given BIM and EVENT use Hazus data to generate a shear model
4. createEDP - given the inputs so far generate the EDP demands
5. performSIMULATION - given all, fill the EDP with data
6. createDL - given all, determine the DL.

NOTE: the applications require the jansson lib be installed. jansson is 
a free BSD lib recomended online for dealing with reading/writing json files.
It is assumed installed in /usr/local/jansson as seen in Makefiles.

NOTE: each subsirectory included provides an application and include example 
input and output .json (the input coming from previous step, the output 
generated by the application given the inputs)

NOTE: running an application w/o any inputs shows what the command line args
should be.


## Pegasus Workflow

The Pegasus workflow can be found in the workflow/ directory. 

The current version of the workflow is set up for rapid development using
a local HTCondor pool. At a later date, the the workflow will be
configured to execute at TACC.

A workflow specific ssh key has to be created. This key is used for some
of the data staging steps of the workflow:

    $ ssh-keygen -t rsa -b 4096 -f ~/.ssh/workflow
      (just hit enter when asked for a passphrase)
          
Authorize the key:

    $ cat ~/.ssh/workflow.pub >>~/.ssh/authorized_keys

You can test that the key was set up correctly by ssh to the local machine:

    $ ssh -i ~/.ssh/workflow $HOSTNAME "echo Hello"

Before submitting, please run `make` to make sure all the executables
required by the workflow have been built.

Submitting a workflow can be done by executing:

    ./submit



